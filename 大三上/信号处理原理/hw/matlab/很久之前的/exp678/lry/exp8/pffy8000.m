[s1, fs]=wavread('3-1-4(1).wav');
[s2, fs]=wavread('3-1-4(2).wav');
[s3, fs]=wavread('3-1-4(3).wav');
t=0:fs*2-1;
sd1=s1((1:fs*2),:);
sd2=s2((1:fs*2),:);
sd3=s3((1:fs*2),:);
x1=4*sd1'.*cos(2*pi*725*t/fs);
x2=4*sd2'.*cos(2*pi*2000*t/fs);
x3=4*sd3'.*cos(2*pi*3265*t/fs);
s=x1+x2+x3;
figure(1);
stem(t,abs(fft(sd1)),'.');
figure(2);
stem(t,abs(fft(sd2)),'.');
figure(3);
stem(t,abs(fft(sd3)),'.');
figure(4);
stem(t,abs(fft(s)),'.');
Rp=0.1;
Rs=8;
Wp1=[725 1450]/4000;
Ws1=[690 1540]/4000;
[n1,Wn1]=cheb2ord(Wp1,Ws1,Rp,Rs);
[b1,a1]=cheby2(n1,Rs,Wn1);
Wp2=[1630 2360]/4000;
Ws2=[1450 2540]/4000;
[n2,Wn2]=cheb2ord(Wp2,Ws2,Rp,Rs);
[b2,a2]=cheby2(n2,Rs,Wn2);
Wp3=[2630 3355]/4000;
Ws3=[2540 3445]/4000;
[n3,Wn3]=cheb2ord(Wp3,Ws3,Rp,Rs);
[b3,a3]=cheby2(n3,Rs,Wn3);
ys=awgn(s,20);
y1=filter(b1,a1,ys);
y2=filter(b2,a2,ys);
y3=filter(b3,a3,ys);
y01=y1.*cos(2*pi*725*t/fs);
y02=y2.*cos(2*pi*2000*t/fs);
y03=y3.*cos(2*pi*3265*t/fs);
Rp=0.1;Rs=8;
Wp1=615/4000;
Ws1=725/4000;
[n1,Wn1]=cheb2ord(Wp1,Ws1,Rp,Rs);
[b1,a1]=cheby2(n1,Rs,Wn1);
yy1=filter(b1,a1,y01);
yy2=filter(b1,a1,y02);
yy3=filter(b1,a1,y03);
figure(5);
stem(t,abs(fft(yy1)),'.');
figure(6);
stem(t,abs(fft(yy2)),'.');
figure(7);
stem(t,abs(fft(yy3)),'.');
figure(8);
plot(t,yy1);
figure(9);
plot(t,sd1);
sound(yy1,fs);
sound(yy2,fs);
sound(yy3,fs);